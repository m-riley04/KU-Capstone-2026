# =============================================================================
# Polypod â€” Central Configuration
# /etc/polypod/polypod.conf
# =============================================================================
# This file is sourced by all Polypod scripts (sway config, deploy, update).
# Edit this to remap displays, change paths, or switch to fallback mode
# WITHOUT rebuilding the image.
# =============================================================================

# --- Display output mapping ---
# These must match the DRM connector names shown by: swaymsg -t get_outputs
# or: ls /sys/class/drm/
#
# Typical values:
#   DSI-2       = Waveshare 3.5" DSI LCD (E)
#   SPI-1       = Waveshare 3.5" SPI LCD (G) via mipi-dbi-spi
#   HDMI-A-1    = HDMI port 0
#   HDMI-A-2    = HDMI port 1
#
# For development without the DSI display, set TOP to an HDMI output.
POLYPOD_TOP_OUTPUT="DSI-2"
POLYPOD_BOTTOM_OUTPUT="SPI-1"

# --- Display resolutions ---
POLYPOD_TOP_RES="640x480"
POLYPOD_BOTTOM_RES="320x480"

# --- Display transforms (none, 90, 180, 270, flipped, flipped-90, etc.) ---
POLYPOD_TOP_TRANSFORM="normal"
POLYPOD_BOTTOM_TRANSFORM="normal"

# --- Flutter app paths ---
POLYPOD_APP_DIR="/opt/polypod"
POLYPOD_TOP_APP="${POLYPOD_APP_DIR}/top/Polypod_Top_Window"
POLYPOD_BOTTOM_APP="${POLYPOD_APP_DIR}/bottom/Polypod_Bottom_Window"

# --- Flutter app_id values (used by Sway's assign rules) ---
# These correspond to the binary name by default in flutter-elinux.
# If your binary is named differently, update these.
POLYPOD_TOP_APP_ID="Polypod_Top_Window"
POLYPOD_BOTTOM_APP_ID="Polypod_Bottom_Window"

# --- SPI fallback mode ---
# If Sway cannot manage the SPI display as a DRM output, set this to "1".
# The bottom app will then render directly to the SPI framebuffer device
# using flutter-elinux's DRM-GBM backend (or fbdev if available).
POLYPOD_SPI_FALLBACK="0"

# --- SPI DRM device (only used when SPI_FALLBACK=0) ---
# The mipi-dbi-spi driver creates a separate DRM card.
# Run: ls /dev/dri/card* and check which is the SPI device.
POLYPOD_SPI_DRM_DEVICE="/dev/dri/card0"
POLYPOD_MAIN_DRM_DEVICE="/dev/dri/card1"

# --- Remote update settings ---
POLYPOD_UPDATE_SERVER=""
POLYPOD_UPDATE_USER="deploy"
POLYPOD_UPDATE_PATH="/releases/latest"
POLYPOD_UPDATE_ENABLED="0"

# --- Watchdog ---
POLYPOD_WATCHDOG_SEC="30"

# --- Debug mode ---
# Set to "1" to enable verbose logging in all scripts
POLYPOD_DEBUG="0"

# --- HDMI as DSI substitute (development mode) ---
# When you don't have the DSI (E) display, set this to "1" and
# POLYPOD_TOP_OUTPUT will be overridden to HDMI-A-1 automatically.
POLYPOD_HDMI_DEV_MODE="0"
